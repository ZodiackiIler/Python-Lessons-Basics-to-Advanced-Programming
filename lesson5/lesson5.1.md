## Урок 5: Работа с базами данных

В этом уроке мы рассмотрим работу с базами данных в языке программирования Python. Вы научитесь подключаться к базе данных, выполнять запросы и манипуляции данными, а также обрабатывать ошибки и исключения, связанные с базами данных.

Часть 1: Подключение к базе данных

Для работы с базами данных в Python нам понадобится использовать специальные библиотеки, такие как `sqlite3`, `mysql-connector`, `psycopg2` и другие, в зависимости от типа базы данных. Прежде чем начать, убедитесь, что вы установили соответствующую библиотеку.

Пример: Подключение к базе данных SQLite с использованием библиотеки `sqlite3`

```python
import sqlite3

# Подключение к базе данных SQLite
conn = sqlite3.connect("mydatabase.db")

# Создание объекта курсора
cursor = conn.cursor()

# Выполнение SQL-запросов
# ...

# Закрытие соединения с базой данных
conn.close()
```

В этом примере мы импортируем библиотеку `sqlite3` и подключаемся к базе данных SQLite с помощью функции `connect()`. Затем мы создаем объект курсора с помощью метода `cursor()`. Курсор используется для выполнения SQL-запросов и манипуляций с данными. После окончания работы с базой данных соединение следует закрыть с помощью метода `close()`.

Часть 2: Запросы и манипуляции данными

После подключения к базе данных мы можем выполнять SQL-запросы и манипуляции данными, такие как создание таблиц, вставка, обновление и удаление данных и другие операции.

Пример: Выполнение SQL-запроса для создания таблицы

```python
# Создание таблицы
cursor.execute("CREATE TABLE IF NOT EXISTS employees (id INTEGER PRIMARY KEY, name TEXT, age INTEGER)")
```

В этом примере мы используем метод `execute()` курсора для выполнения SQL-запроса создания таблицы "employees". Если таблица уже существует, то операция будет проигнорирована благодаря условию `IF NOT EXISTS`.

Пример: Выполнение SQL-запроса для вставки данных

```python
# Вставка данных в таблицу
cursor.execute("INSERT INTO employees (id, name, age) VALUES (1, 'John', 30)")
```

В этом примере мы используем метод `execute()` для выполнения SQL-запроса вставки данных в таблицу "employees". Значения для вставки указываются в операторе `VALUES`.

Часть 3: Обработка ошибок и исключений

При работе с базами данных могут возникать ошибки и исключения, связанные с соединением, запросами и другими операциями. Важно обрабатывать эти ошибки, чтобы обеспечить надежность и безопасность вашей программы.

Пример: Обработка ошибок и исключений при выполнении запроса

```python
try:
    # Выполнение SQL-запроса
    cursor.execute("SELECT * FROM employees")
    
    # Получение результатов
    results = cursor.fetchall()
    
    # Обработка результатов
    for row in results:
        print(row)
except Exception as e:
    # Обработка ошибок
    print("Ошибка при выполнении запроса:", e)
```

В этом примере мы используем конструкцию `try-except` для обработки исключений, которые могут возникнуть при выполнении SQL-запроса. В блоке `try` мы выполняем запрос и получаем результаты с помощью метода `fetchall()`. Если возникает исключение, оно перехватывается блоком `except`, и мы можем обработать ошибку или вывести сообщение об ошибке.

Работа с базами данных предоставляет возможность эффективно хранить и получать данные. Python предоставляет различные библиотеки для работы с различными типами баз данных. При использовании баз данных важно учитывать безопасность и обрабатывать ошибки, чтобы гарантировать надежность и целостность данных.
